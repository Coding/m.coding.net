(function(){var a,b,c=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},d=[].slice;window.Routy||(window.Routy={}),a=window.History,b={},Routy.Router=function(){function a(a,b,c,d){this.state_changers_selector=b,this.event=d,a||(a=""),""!==a&&("/"===a[0]&&(a=a.substr(1)),"/"===a.substr(-1)&&(a=a.substr(0,a.length-1))),this.context=a,this.state_changers_selector||(this.state_changers_selector="a"),c||(c=document),this.context_selector=$(c),this.event||(this.event="click"),this.attach()}return a.prototype.actions=[],a.prototype["default"]=null,a.prototype.apply_context=function(a){return a=""!==a?"/"!==a[0]?this.context+a:this.context+a:this.context+"/"},a.prototype.attach=function(){var a;return a=this,$(window).load(function(){return a.run.call(a,"/")}),this.context_selector.on(this.event,this.state_changers_selector,function(b){var c;return b.preventDefault(),c=$(this).attr("href")||$(this).children("a").attr("href"),null!=c?a.run.call(a,c,b.type):void 0}),$(window).bind("popstate",function(b){return a.run.call(a,b.state.state)})},a.prototype.go=function(a,b,c){var d;return d=c||{},d.state=a,window.history.pushState(d,b||document.title,a)},a.prototype.register=function(a,b){var c,d,e,f,g,h,i,j;return j=b.template_url,g=b.events||this.event.split(" "),e=b.context,d=b.before_enter,f=b.on_enter,c=b.after_enter,h=b.on_exit,i=new Routy.Action(a,j,g,$(e),this,d,f,c,h),b["default"]&&(this["default"]=a),this.actions.push(i)},a.prototype.rootRegister=function(a,b){return this.register("",a,b)},a.prototype.run=function(a,b){var d,e,f,g,h,i,j,k,l,m;for(l=this.actions,h=0,j=l.length;j>h;h++)if(d=l[h],!b||b&&c.call(d.events,b)>=0)for(m=d.route,i=0,k=m.length;k>i;i++)if(g=m[i],f=this.pathRegExp(g,{}).regexp,e=a.match(f),null!=e)return this.go(a),e.shift(),d.call.apply(d,e);return this["default"]?this.run(this["default"]):void 0},a.prototype.pathRegExp=function(a,b){var c,d,e;return c=b.caseInsensitiveMatch,e={originalPath:a,regexp:a},d=e.keys=[],a=a.replace(/([().])/g,"\\$1").replace(/(\/)?:(\w+)([\?\*])?/g,function(a,b,c,e){var f,g;return f="?"===e?e:null,g="*"===e?e:null,d.push({name:c,optional:!!f}),b=b||"",""+(f?"":b)+"(?:"+(f?b:"")+(g&&"(.+?)"||"([^/]+)")+(f||"")+")"+(f||"")}).replace(/([\/$\*])/g,"\\$1"),e.regexp=new RegExp("^"+a+"$",c?"i":""),e},a}(),Routy.Action=function(){function a(a,b,c,d,e,f,g,h,i){var j,k,l,m;for(this.template_url=b,this.events=c,this.context=d,this.router=e,this.before_callback=f,this.callback=g,this.after_callback=h,this.on_exit_callback=i,"string"==typeof a&&(a=a.split(", ")),j=[],this.events=this.events||[],l=0,m=a.length;m>l;l++)k=a[l],k=this.router.apply_context(k),j.push(k);this.route=j}return a.prototype.route=[],a.prototype.context=$("body"),a.prototype.template_url=null,a.prototype.template=null,a.prototype.callback=null,a.prototype.before_callback=null,a.prototype.after_callback=null,a.prototype.condition=null,a.prototype.on_exit_callback=null,a.prototype.events=[],a.prototype.call=function(){var a,b,c=this;return a=1<=arguments.length?d.call(arguments,0):[],b=!0,this.condition&&(b=this.condition.apply(this,a)),this.template?this.digest(a):$.get(this.template_url,function(b){return c.template=b,c.digest(a)})},a.prototype.digest=function(a){return null!=b.on_exit_callback&&b.on_exit_callback.apply(this,a),this.before_callback&&this.before_callback.apply(this,a),this.context.html(this.template),this.callback.apply(this,a),this.after_callback&&this.after_callback.apply(this,a),b=this},a}()}).call(this);var PROJECT_ITEM_ROUTE=function(){function a(a,b){var d=f,e=g,a=a||"master",b=b||"",j="/api/user/"+d+"/project/"+e+"/git/tree/"+a+"/"+b;h=a,i=b,$.ajax({url:j,dataType:"json",success:function(){c()},error:function(){alert("Failed to load commits"),$("#project_code > .panel-heading").html(""),$("#project_readme > .panel-body").html("")}})}function b(){var a="/api/user/"+f+"/project/"+g;$.ajax({url:a,dataType:"json",success:function(a){j=a.data,d(a.data)},error:function(){alert("Failed to load project"),$("#project_actions a:first").text(""),$("#project_actions a:last").text("")}})}function c(a){var b=a||{ref:"master",lastCommitter:{name:"ElevenChen",email:"skyhacker@126.com",avatar:"https://dn-coding-net-production-static.qbox.me/c1caa543-f158-41c4-a74a-6ccbf7b7f36c.jpeg?imageMogr2/auto-orient/format/jpeg/crop/!180x180a0a0",link:"/u/elevenchen"},files:[{mode:"tree",path:".settings",name:".settings"},{mode:"tree",path:"coffee",name:"coffee"},{mode:"tree",path:"frameworks",name:"frameworks"},{mode:"tree",path:"images",name:"images"},{mode:"tree",path:"libs",name:"libs"},{mode:"tree",path:"publish",name:"publish"},{mode:"tree",path:"res",name:"res"},{mode:"tree",path:"src",name:"src"},{mode:"file",path:".cocos-project.json",name:".cocos-project.json"},{mode:"file",path:".gitignore",name:".gitignore"},{mode:"file",path:".project",name:".project"},{mode:"file",path:"Gulpfile.js",name:"Gulpfile.js"},{mode:"file",path:"Procfile",name:"Procfile"},{mode:"file",path:"WeixinApi.js",name:"WeixinApi.js"},{mode:"file",path:"app.js",name:"app.js"},{mode:"file",path:"build-android.sh",name:"build-android.sh"},{mode:"file",path:"config.json",name:"config.json"},{mode:"file",path:"index.html",name:"index.html"},{mode:"file",path:"main.js",name:"main.js"},{mode:"file",path:"package.json",name:"package.json"},{mode:"file",path:"project.json",name:"project.json"},{mode:"file",path:"publish.sh",name:"publish.sh"},{mode:"file",path:"readme.md",name:"readme.md"},{mode:"file",path:"run-android.sh",name:"run-android.sh"},{mode:"file",path:"runweb.sh",name:"runweb.sh"}],can_edit:!1,isHead:!0,readme:{data:"#空降小色块\n\n![image](https://coding.net/u/elevenchen/p/FlyBlock/git/raw/master/res/favicon.png)\n\n本项目使用cocos2d-js引擎\n\n使用coffeescript开发\n\n使用gulp前端构建工具构建coffeescript脚本\n\n##初始化:\n\n```\nnpm install\n```\n##编译\n\n```\ngulp\n```\n\n##运行\n\n```\n./runweb.sh\n```\n注意：需要把`runweb.sh`文件的引擎地址改成本机的\n\n##发布\n\n```\n./publish.sh\n```\n\n同样需要注意文件内容修改\n\n##部署\n\n```\nnode app.js\n```\n",lang:"markdown",size:471,previewed:!0,preview:'<h1>空降小色块</h1> \n<p><img src="https://coding.net/u/elevenchen/p/FlyBlock/git/raw/master/res/favicon.png" alt="image"></p> \n<p>本项目使用cocos2d-js引擎</p> \n<p>使用coffeescript开发</p> \n<p>使用gulp前端构建工具构建coffeescript脚本</p> \n<h2>初始化:</h2> \n<pre><code>npm install\n</code></pre> \n<h2>编译</h2> \n<pre><code>gulp\n</code></pre> \n<h2>运行</h2> \n<pre><code>./runweb.sh\n</code></pre> \n<p>注意：需要把<code>runweb.sh</code>文件的引擎地址改成本机的</p> \n<h2>发布</h2> \n<pre><code>./publish.sh\n</code></pre> \n<p>同样需要注意文件内容修改</p> \n<h2>部署</h2> \n<pre><code>node app.js\n</code></pre>',lastCommitMessage:"增加readme.md\n",lastCommitDate:141864758e4,lastCommitId:"442eb449154518918b70c98ca4a0423068c05b8c",lastCommitter:{name:"ElevenChen",email:"skyhacker@126.com",avatar:"https://dn-coding-net-production-static.qbox.me/c1caa543-f158-41c4-a74a-6ccbf7b7f36c.jpeg?imageMogr2/auto-orient/format/jpeg/crop/!180x180a0a0",link:"/u/elevenchen"},mode:"file",path:"readme.md",name:"readme.md"},lastCommit:{fullMessage:"update\n",shortMessage:"update\n",commitId:"7aa32afc1e7e0ed179d35808896e92a73ef99246",commitTime:1419342157e3,committer:{name:"ElevenChen",email:"skyhacker@126.com",avatar:"https://dn-coding-net-production-static.qbox.me/c1caa543-f158-41c4-a74a-6ccbf7b7f36c.jpeg?imageMogr2/auto-orient/format/jpeg/crop/!180x180a0a0",link:"/u/elevenchen"}}},c=b.lastCommit,d=b.files,f=b.readme.preview;$(".commit").addClass("alert alert-info"),$(".commit > .comment-meta").text(c.shortMessage),$(".commit > .comment-hash > a").attr("href",g+"/git/commit/"+c.commitId).text(c.commitId.substr(0,10));var h='<span class="panel-title"><img src="'+c.committer.avatar+'" height="20" width="20"> '+c.committer.name+" </span>";$("#project_code > .panel-heading").html(h),$("#project_readme > .panel-body").html(f);for(var i=null,j=null,k=0;k<d.length;k++)i=d[k],j=e(i),$("#project_code > .list-group").append(j)}function d(a){var b=a||{};$("#project_actions a:first").text(b.stared?" 已收藏("+b.star_count+") ":" 收藏("+b.star_count+") "),$("#project_actions a:last").text(b.watched?" 已关注("+b.watch_count+") ":" 关注("+b.watch_count+") ");var c='<img src="'+b.icon+'" height="40" width="40"> <a href="'+b.owner_path+'">'+b.owner_user_name+'</a>/<a href="'+b.project_path+'">'+b.name+"</a>";$("#project_owner").html(c),$("#project_description").text(b.description)}function e(a){var b='<li class="list-group-item list-group-item-info glyphicon"> </li>',c='<a href="#"></a>',d=null;if("file"===a.mode){var e=$(c).attr("href",g+"/git/tree/"+h+"/"+a.path).text(a.name);d=$(b).addClass("glyphicon-list-alt").append(e)}else if("tree"===a.mode){var e=$(c).attr("href",g+"/git/blob/"+h+"/"+a.path).text(a.name);d=$(b).addClass("glyphicon-folder-close").append(e)}return d}var f,g,h,i,j;return{template_url:"/views/project.html",context:".container",before_enter:function(a,b){var c="/u/"+a+"/p/"+b;$("title").text(a+"/"+b),$("#page_name").html('<a href="#">'+a+'</a>/<a href="'+c+'">'+b+"</a>"),$("#navigator").append('<li class="nav-divider"></li><li><a href="'+c+'/code">代码</a></li><li><a href="#">合并请求</a></li><li><a href="#">讨论</a></li><li><a href="#">演示</a></li><li><a href="#">质量管理</a></li>'),$('<div id="project_actions" class="btn-group btn-group-justified" role="group" aria-label="..."><div class="btn-group" role="group"><a class="btn btn-default glyphicon glyphicon-star"> <span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> </a></div><div class="btn-group" role="group"><a class="btn btn-default glyphicon glyphicon-eye-open"> <span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> </a></div></div>').insertAfter($("#bs-example-navbar-collapse-1")),$("#navigator").find("li:eq(5)").addClass("active")},on_enter:function(c,e){f=c,g=e,b(),a(),$("#project_actions a.glyphicon-star").click(function(a){if(a.preventDefault(),j){var b="/api/user/"+f+"/project/"+g;b+=j.stared?"/unstar":"/star",$(this).html(' <span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> '),$.post(b,function(){j.stared=!j.stared,j.stared?j.star_count+=1:j.star_count-=1,d(j)})}}),$("#project_actions a.glyphicon-eye-open").click(function(a){if(a.preventDefault(),j){var b="/api/user/"+f+"/project/"+g;b+=j.watched?"/unwatch":"/watch",$(this).html(' <span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> '),$.post(b,function(){j.watched=!j.watched,j.watched?j.watch_count+=1:j.watch_count-=1,d(j)})}})},on_exit:function(){$("title").text(""),$("#page_name").text(""),$("#navigator").find("li").removeClass("active"),$("#navigator > li").slice(-6).remove(),$("#project_actions").remove()}}}(),PROJECT_ROUTE=function(){function a(a){var c,d,a=a||{code:0,data:{}},e=a.data.list,f=document.createDocumentFragment();g=document.getElementById("projects_list");for(var i=0;i<e.length;i++)c=e[i],d=b(c),f.appendChild(d[0]),h.push(c);g.appendChild(f)}function b(a){var b='<a href="#" class="list-group-item"><h4 class="list-group-item-heading"><img src="#" width="40" height="40"> <span></span><span class="glyphicon glyphicon-eye-open pull-right icon-small" aria-hidden="true"></span><span class="glyphicon glyphicon-random pull-right icon-small" aria-hidden="true"></span></h4><p class="list-group-item-text"><span></span></p></a>',c=$(b);return c.attr("href",a.project_path),c.find("h4 > img").attr("src",a.icon),c.find("h4 > span:first").text(a.name),c.find("h4 > span:eq(1)").text(a.fork_count),c.find("h4 > span:eq(2)").text(a.watch_count),c.find("p > span:first").text(a.description),c.on("swipe click",function(a){a.preventDefault(),$(g).find("a").removeClass("active"),$(this).addClass("active")}),c}function c(b){f++;var c=this;c.html('<span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> 读取中...'),b+="?page="+f+"&pageSize="+e,$.ajax({url:b,dataType:"json",success:function(b){a(b)},error:function(){alert("Failed to load projects")},complete:function(){c.text("更多项目")}})}function d(){for(var a,c=document.createDocumentFragment(),d=document.getElementById("projects_list"),e=0;e<h.length;e++)a=b(h[e]),c.appendChild(a[0]);d.appendChild(c)}var e=10,f=0,g=null,h=[];return{template_url:"/views/projects.html",context:".container",before_enter:function(){$("title").text("精彩项目"),$("#page_name").text("精彩项目"),$("#navigator").find("li:first").addClass("active")},on_enter:function(){if(0===h.length){var a=$("#load_more");c.call(a,"/api/public/all")}else d();var a=$("#load_more");a.on("click",function(a){a.preventDefault(),c.call($(this),"/api/public/all")})},on_exit:function(){$("title").text(""),$("#page_name").text(""),$("#navigator").find("li").removeClass("active")},"default":!0}}(),PP_ROUTE=function(){function a(a){var c,a=a||{code:0,data:[]},d=a.data,e=document.createDocumentFragment();j=document.getElementById("pp_list");for(var f=0;f<d.length;f++)c=b(d[f]),e.appendChild(c[0]),k[d[f].id]=d[f];j.appendChild(e)}function b(a){var e='<div class="detailBox"><div class="titleBox"><div class="commenterImage"><a href="#"><img src="#" height="30" width="30" /></a></div><a class="commenterName" href="#"><label></label></a><a href="#" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><a href="#" class="pull-right star"><span class="glyphicon glyphicon-heart"></span></a><a href="#" class="pull-right comment"><span class="glyphicon glyphicon-comment"></span></a><div class="row"><div class="col-sm-12 like_users"></div></div></div><div class="commentBox"><p class="taskDescription"></p></div><div class="actionBox"><ul class="commentList"></ul><form class="form-inline commentSubmit" role="form"><div class="input-group"><input type="text" class="form-control" placeholder="在此输入评论内容"><span class="input-group-btn"><button class="btn btn-default" type="submit"><span class="glyphicon glyphicon-arrow-right"></span></button></span></div></form></div></div>',f=$(e);f.attr("id",a.id);var g=a.owner.name,h=a.owner.global_key;f.find(".titleBox > .commenterImage > a").attr("href","/u/"+h),f.find(".titleBox > .commenterImage > a > img").attr("src",a.owner.avatar),f.find(".titleBox > a.commenterName").attr("href","/u/"+h),f.find(".titleBox > a.commenterName > label").text(g),f.find(".titleBox > a.star > span").text(a.likes),a.liked&&f.find(".titleBox > a.star > span").css("color","#D95C5C");for(var i,j=a.like_users,l=f.find(".titleBox .like_users"),m=0;m<j.length;m++)i=d(j[m]),l.append(i);f.find(".titleBox > a.comment").attr("href","/u/"+h+"/pp/"+a.id),f.find(".titleBox > a.comment > span").text(a.comments),f.find(".commentBox > .taskDescription").html(a.content);for(var n,o=a.comment_list,p=f.find(".actionBox > .commentList"),q=0;q<o.length;q++)n=c(o[q]),p.append(n);return f.on("click",".star",function(c){c.preventDefault();var d=a.id,e=a.liked?"/api/tweet/"+d+"/unlike":"/api/tweet/"+d+"/like";return $.post(e,function(){a.liked=!a.liked,a.liked?a.likes+=1:a.likes-=1;var c=b(a);f.replaceWith(c),k[d]=a}),!1}),f.on("click",".close",function(b){b.preventDefault();var c=confirm("确认删除该泡泡？");if(c){var d=a.id,e="/api/tweet/"+d;$.ajax({url:e,type:"DELETE",success:function(a){if(a.msg)for(var b in a.msg)alert(a.msg[b]);else delete k[d],f.remove()}})}return!1}),f.on("submit",".commentSubmit",function(b){b.preventDefault();var d=a.id,e=$(this).find("input"),f=$(this).find("button"),g="/api/tweet/"+d+"/comment";return $.post(g,{content:e.val()},function(a){if(a.msg)for(var b in a.msg)alert(a.msg[b]);if(a.data){a.data.owner={};var d=c(a.data);p.append(d)}e.removeAttr("disabled"),f.removeAttr("disabled")}),e.attr("disabled","disabled"),f.attr("disabled","disabled"),!1}),f}function c(a){var b='<li><div class="commenterImage"><a href="#"><img src="#" /></a></div><a class="commenterName" href="#"><span class="comment-meta"></span></a><div class="commentText"><p></p><span class="date sub-text"></span><a class="reply" href="#" class="comment-hash"> 回复 </a><a class="delete" href="#" class="comment-hash"> 删除 </a></div></li>',c=$(b),d=a.owner.name,e=a.owner.global_key;return c.find(".commenterImage > a").attr("href","/u/"+e),c.find(".commenterImage img").attr("src",a.owner.avatar),c.find("a.commenterName").attr("href","/u/"+e),c.find("a.commenterName > span").text(d),c.find(".commentText > p").html(a.content),c.find(".commentText > .date").text(new Date(a.created_at)),c.find(".commentText > a").attr("id",a.owner_id),c.on("click",".reply",function(a){a.preventDefault();var b=c.parents(".commentList").next("form").find("input");if(""===b.val())b.val("@"+d);else{var e=b.val();b.val(e+", @"+d)}return!1}),c.on("click",".delete",function(b){b.preventDefault();var d=confirm("确认删除该评论？");if(d){var e=c.parents(".detailBox").attr("id"),f=a.id;path="/api/tweet/"+e+"/comment/"+f,$.ajax({url:path,type:"DELETE",success:function(a){if(a.msg)for(var b in a.msg)alert(a.msg[b]);else{for(var d=k[e].comment_list,g=d.length-1;g>=0;g--)d[g].id===f&&d.splice(g,1);c.remove()}}})}return!1}),c}function d(a){var b='<a class="pull-right" style="padding: 0 3px 0" href="#"><img src="#" height="15" width="15" /></a>',c=$(b);return c.attr("href","/u/"+a.global_key),c.find("img").attr("src",a.avatar),c}function e(){k={},h=99999999}function f(){k={},h=99999999,$("#pp_list > .detailBox").remove(),g("/api/tweet/public_tweets")}function g(b){var c=$("#load_more"),d=$("#refresh");c.html('<span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> 读取中...'),d.children("span").addClass("glyphicon-refresh-animate"),b+="?last_id="+h+"&sort="+i,$.ajax({url:b,dataType:"json",success:function(b){a(b),h=b.data[b.data.length-1].id},error:function(){alert("Failed to load pp")},complete:function(){c.text("更多泡泡"),d.children("span").removeClass("glyphicon-refresh-animate")}})}var h=99999999,i="time",j=null,k={};return{template_url:"/views/pp.html",context:".container",before_enter:function(a){$("title").text("冒泡"),$("#page_name").text("冒泡"),$("#navigator").append('<li class="nav-divider"></li><li><a href="/pp/hot">热门</a></li>'),$('<div id="pp_actions" class="btn-group btn-group-justified" role="group" aria-label="..."><div class="btn-group" role="group"><a class="btn btn-default glyphicon glyphicon-edit" data-toggle="modal" data-target="#pp_input"> 来，冒个泡吧！ </a></div><div class="btn-group" role="group"><a class="btn btn-default glyphicon glyphicon glyphicon-camera"> 发图片 </a></div></div>').insertAfter($("#bs-example-navbar-collapse-1")),"hot"===a?$("#navigator").find("li:last-child").addClass("active"):$("#navigator").find("li:eq(1)").addClass("active")},on_enter:function(a){i="hot"===a?"hot":"time",f(),$("#load_more").on("click",function(a){a.preventDefault(),g("/api/tweet/public_tweets")}),$("#refresh").on("click",function(a){a.preventDefault(),f()}),$("#pp_input").on("click","#pp_submit",function(a){a.preventDefault();var c=$("#pp_content"),d=$(this);return""!==c.val()&&(d.attr("disabled","disabled"),$.post("/api/tweet",{content:c.val()},function(a){if(a.msg)for(var e in a.msg)alert(a.msg[e]);if(a.data){a.data.owner={};var f=b(a.data);j.prepend(f),c.val(""),$("#pp_input").modal("hide")}d.removeAttr("disabled")})),!1})},on_exit:function(){$("title").text(""),$("#page_name").text(""),$("#navigator > li").slice(-1).remove(),$("#pp_actions").remove(),$("#navigator").find("li").removeClass("active"),e()}}}(),PP_ITEM_ROUTE=function(){function a(a){var b="/api/user/key/"+a;$.ajax({url:b,dataType:"json",success:function(a){c(a.data)},error:function(){alert("Failed to load user"+a),$("#user-heading").html("")}})}function b(a,b){var c="/api/tweet/"+a+"/"+b;$.ajax({url:c,dateType:"json",success:function(a){b=a.data,d(b)},error:function(){alert("Failed to load pp"+b)},complete:function(){$("button.btn-warning").remove()}})}function c(a){var b=a||{tags_str:"PHP, Go, Javascript, Node.js, 专注前端一百年",tags:"4,5,11,12,27",job_str:"开发",job:1,sex:0,birthday:"1970-01-01",location:"广东 深圳",company:"鹅厂",slogan:"生命在于折腾",introduction:"",avatar:"https://dn-coding-net-production-static.qbox.me/19ab9751-12cc-4e06-bf89-015d77ab8fae.jpg?imageMogr2/auto-orient/format/jpeg/crop/!170x170a0a0",gravatar:"",lavatar:"https://dn-coding-net-production-static.qbox.me/19ab9751-12cc-4e06-bf89-015d77ab8fae.jpg?imageMogr2/auto-orient/format/jpeg/crop/!170x170a0a0",created_at:1404879208e3,last_logined_at:1420427362e3,last_activity_at:1421290052354,global_key:"f2e",name:"f2e",updated_at:1404879208e3,path:"/u/f2e",status:1,is_member:0,id:290,follows_count:15,fans_count:8,tweets_count:41,followed:!1,follow:!1},d='<h4 class="panel-title"><img src="#" height="25" width="25" /><a class="panel-title" data-toggle="collapse" href="#accordion" data-target="#user-details" aria-expanded="true" aria-controls="user-details"></a><a href="#" class="pull-right watched"></a><a href="#" class="pull-right followed"></a></h4>',e='<p><span class="description" ></span></p><p><button type="button" class="btn btn-primary follow"></button><button type="button" class="btn btn-default message">给TA私信</button></p><table class="table"><tr class="join"><td>加入时间</td><td></td></tr><tr class="activity"><td>最后活动</td><td></td></tr><tr class="sufix"><td>个性后缀</td><td></td></tr></table>',f=$(d),g=$(e);f.find("img").attr("src",b.avatar),f.find("a.panel-title").text(" "+b.name+" "),f.find("a.watched").attr("href","/u/"+b.global_key+"/followers").text(" "+b.fans_count+"粉丝 "),f.find("a.followed").attr("href","/u/"+b.global_key+"/friends").text(" "+b.follows_count+"关注 "),f.click(function(a){a.preventDefault();var b=$("#user-details");return b.collapse(b.hasClass("in")?"hide":"show"),!1});var h=g.find("button.follow");if(h.text(b.followed?"取消关注":"关注"),g.find(".description").text(b.slogan),g.find("table .join td:eq(1)").text(new Date(b.created_at)),g.find("table .activity td:eq(1)").text(new Date(b.last_activity_at)),g.find("table .sufix td:eq(1)").text(b.global_key),""!==b.sex){var i=0===b.sex?"男":"女";g.find("table tbody").append('<tr class="sex"><td>性别</td><td>'+i+"</td></tr>")}if(""!==b.job_str&&g.find("table tbody").append('<tr class="job"><td>工作</td><td>'+b.job_str+"</td></tr>"),""!==b.location&&g.find("table tbody").append('<tr class="location"><td>地点</td><td>'+b.location+"</td></tr>"),""!==b.tags_str){for(var j=b.tags_str.split(","),k=[],l=0;l<j.length;l++){var m=j[l],n='<a href="/tags/search/'+m+'">'+m+"</a>";k.push(n)}g.find("table tbody").append('<tr class="tags"><td>标签</td><td>'+k.join()+"</td></tr>")}g.on("click","button.follow",function(a){a.preventDefault(),h.attr("disabled","disabled");var d=b.followed?"/api/user/unfollow":"/api/user/follow";$.post(d+"?users="+b.global_key,function(a){if(a.msg)for(var d in a.msg)alert(a.msg[d]);else b.followed=!b.followed,b.follows_count=b.followed?b.follows_count+1:b.follows_count-1,c(b);h.removeAttr("disabled")})}),$("#user-details > .panel-body").html(g),$("#user-heading").html(f)}function d(a){var b=a||{id:18926,owner_id:290,owner:{tags_str:"PHP, Go, Javascript, Node.js, 专注前端一百年",tags:"4,5,11,12,27",job_str:"开发",job:1,sex:0,birthday:"1970-01-01",location:"广东 深圳",company:"鹅厂",slogan:"生命在于折腾",introduction:"",avatar:"https://dn-coding-net-production-static.qbox.me/19ab9751-12cc-4e06-bf89-015d77ab8fae.jpg?imageMogr2/auto-orient/format/jpeg/crop/!170x170a0a0",gravatar:"",lavatar:"https://dn-coding-net-production-static.qbox.me/19ab9751-12cc-4e06-bf89-015d77ab8fae.jpg?imageMogr2/auto-orient/format/jpeg/crop/!170x170a0a0",created_at:1404879208e3,last_logined_at:1420427362e3,last_activity_at:1421290052354,global_key:"f2e",name:"f2e",updated_at:1404879208e3,path:"/u/f2e",status:1,is_member:0,id:290,follows_count:0,fans_count:0,tweets_count:0,followed:!1,follow:!1},created_at:1421288642e3,likes:3,comments:5,comment_list:[{id:46682,tweet_id:18926,owner_id:43418,owner:{tags_str:"PHP, Javascript, 专注前端一百年, 吐槽帝",tags:"4,11,27,39",job_str:"开发",job:1,sex:0,birthday:"1985-01-01",location:"",company:"",slogan:"",introduction:"",avatar:"https://dn-coding-net-avatar.qbox.me/5f0b7693-fd37-4959-a4e8-44a0061b412c.png",gravatar:"https://dn-coding-net-avatar.qbox.me/5f0b7693-fd37-4959-a4e8-44a0061b412c.png",lavatar:"https://dn-coding-net-avatar.qbox.me/5f0b7693-fd37-4959-a4e8-44a0061b412c.png",created_at:1415933322e3,last_logined_at:1418821489e3,last_activity_at:1421289991251,global_key:"sfwxp",name:"有追求的大鸟",updated_at:1415933322e3,path:"/u/sfwxp",status:1,is_member:0,id:43418,follows_count:0,fans_count:0,tweets_count:0,followed:!1,follow:!1},created_at:1421289991e3,content:'那我八成是连毛巾都拿不到了~ \n<img class="emotion emoji" src="https://coding.net/static/emojis/joy.png" title="joy">'},{id:46679,tweet_id:18926,owner_id:290,owner:{tags_str:"PHP, Go, Javascript, Node.js, 专注前端一百年",tags:"4,5,11,12,27",job_str:"开发",job:1,sex:0,birthday:"1970-01-01",location:"广东 深圳",company:"鹅厂",slogan:"生命在于折腾",introduction:"",avatar:"https://dn-coding-net-production-static.qbox.me/19ab9751-12cc-4e06-bf89-015d77ab8fae.jpg?imageMogr2/auto-orient/format/jpeg/crop/!170x170a0a0",gravatar:"",lavatar:"https://dn-coding-net-production-static.qbox.me/19ab9751-12cc-4e06-bf89-015d77ab8fae.jpg?imageMogr2/auto-orient/format/jpeg/crop/!170x170a0a0",created_at:1404879208e3,last_logined_at:1420427362e3,last_activity_at:1421290052354,global_key:"f2e",name:"f2e",updated_at:1404879208e3,path:"/u/f2e",status:1,is_member:0,id:290,follows_count:0,fans_count:0,tweets_count:0,followed:!1,follow:!1},created_at:142128975e4,content:'<a class="at-someone" href="/u/heby" rel="nofollow">@heby</a> 两个益达。。'},{id:46677,tweet_id:18926,owner_id:32654,owner:{tags_str:"Mac, Javascript, Node.js, 技术宅, 请叫我设计湿, 屌丝码士",tags:"9,11,12,25,36,37",job_str:"开发",job:1,sex:0,birthday:"1992-09-04",location:"广东 深圳",company:"",slogan:"你必须非常努力，才能看上去毫不费力",introduction:"",avatar:"https://dn-coding-net-production-static.qbox.me/fd2d9076-a577-4822-9ed6-de8d0c62ddda.jpg?imageMogr2/auto-orient/format/jpeg/crop/!180x180a0a0",gravatar:"",lavatar:"https://dn-coding-net-production-static.qbox.me/fd2d9076-a577-4822-9ed6-de8d0c62ddda.jpg?imageMogr2/auto-orient/format/jpeg/crop/!180x180a0a0",created_at:141129544e4,last_logined_at:1420648277e3,last_activity_at:1421289738968,global_key:"heby",name:"heby",updated_at:141129544e4,path:"/u/heby",status:1,is_member:0,id:32654,follows_count:0,fans_count:0,tweets_count:0,followed:!1,follow:!1},created_at:1421289696e3,content:"快说！"},{id:46661,tweet_id:18926,owner_id:290,owner:{tags_str:"PHP, Go, Javascript, Node.js, 专注前端一百年",tags:"4,5,11,12,27",job_str:"开发",job:1,sex:0,birthday:"1970-01-01",location:"广东 深圳",company:"鹅厂",slogan:"生命在于折腾",introduction:"",avatar:"https://dn-coding-net-production-static.qbox.me/19ab9751-12cc-4e06-bf89-015d77ab8fae.jpg?imageMogr2/auto-orient/format/jpeg/crop/!170x170a0a0",gravatar:"",lavatar:"https://dn-coding-net-production-static.qbox.me/19ab9751-12cc-4e06-bf89-015d77ab8fae.jpg?imageMogr2/auto-orient/format/jpeg/crop/!170x170a0a0",created_at:1404879208e3,last_logined_at:1420427362e3,last_activity_at:1421290052354,global_key:"f2e",name:"f2e",updated_at:1404879208e3,path:"/u/f2e",status:1,is_member:0,id:290,follows_count:0,fans_count:0,tweets_count:0,followed:!1,follow:!1},created_at:14212889e5,content:'<a class="at-someone" href="/u/skiy" rel="nofollow">@skiy</a> 还真不是 \n<img class="emotion emoji" src="https://coding.net/static/emojis/bomb.png" title="bomb">'},{id:46660,tweet_id:18926,owner_id:33054,owner:{tags_str:"PHP, MySQL, Lua",tags:"4,16,45",job_str:"开发",job:1,sex:0,birthday:"1988-04-14",location:"广东 深圳",company:"某某公司",slogan:"一直在学习，从未超越过。",introduction:"",avatar:"https://dn-coding-net-production-static.qbox.me/c35ead42-c0a0-46e6-9408-a9978ca0d005.jpg?imageMogr2/auto-orient/format/jpeg/crop/!638x638a0a0",gravatar:"",lavatar:"https://dn-coding-net-production-static.qbox.me/c35ead42-c0a0-46e6-9408-a9978ca0d005.jpg?imageMogr2/auto-orient/format/jpeg/crop/!638x638a0a0",created_at:1411640969e3,last_logined_at:1420911615e3,last_activity_at:1421288878901,global_key:"skiy",name:"skiy",updated_at:1411640969e3,path:"/u/skiy",status:1,is_member:0,id:33054,follows_count:0,fans_count:0,tweets_count:0,followed:!1,follow:!1},created_at:1421288852e3,content:"毛巾。"}],device:"",content:'<p>Coding的礼物收到了，我不会说是什么的<img class="emotion emoji" src="https://coding.net/static/emojis/laughing.png" title="laughing"></p>',path:"/u/f2e/pp/18926",activity_id:730906,liked:!1,like_users:[{global_key:"icewing",name:"冰翼",path:"/u/icewing",avatar:"https://dn-coding-net-production-static.qbox.me/1a45a6ea2b8dc025c3512eb577d01ccd.png"},{global_key:"desperatecat",name:"猫爷",path:"/u/desperatecat",avatar:"https://dn-coding-net-production-static.qbox.me/2b778891-e8e8-43ed-a5fc-be0f807e23eb.jpg?imageMogr2/auto-orient/format/jpeg/crop/!640x640a0a0"},{global_key:"jaysun",name:"卡基猫",path:"/u/jaysun",avatar:"https://dn-coding-net-production-static.qbox.me/1d3476cac70c29fe779592a42ea7bff2.png"}]},c='<div class="detailBox"><div class="titleBox"><div class="commenterImage"><a href="#"><img src="#" height="30" width="30" /></a></div><a class="commenterName" href="#"><label></label></a><a href="#" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></a><a href="#" class="pull-right star"><span class="glyphicon glyphicon-heart"></span></a><a href="#" class="pull-right comment"><span class="glyphicon glyphicon-comment"></span></a><div class="row"><div class="col-sm-12 like_users"></div></div></div><div class="commentBox"><p class="taskDescription"></p></div><div class="actionBox"><ul class="commentList"></ul><form class="form-inline commentSubmit" role="form"><div class="input-group"><input type="text" class="form-control" placeholder="在此输入评论内容"><span class="input-group-btn"><button class="btn btn-default" type="submit"><span class="glyphicon glyphicon-arrow-right"></span></button></span></div></form></div></div>',h=$(c);h.attr("id",b.id);var i=b.owner.name,j=b.owner.global_key;h.find(".titleBox > .commenterImage > a").attr("href","/u/"+j),h.find(".titleBox > .commenterImage > a > img").attr("src",b.owner.avatar),h.find(".titleBox > a.commenterName").attr("href","/u/"+j),h.find(".titleBox > a.commenterName > label").text(i),h.find(".titleBox > a.star > span").text(b.likes),b.liked&&h.find(".titleBox > a.star > span").css("color","#D95C5C");for(var k,l=b.like_users,m=h.find(".titleBox .like_users"),n=0;n<l.length;n++)k=f(l[n]),m.append(k);h.find(".titleBox > a.comment").attr("href","/u/"+j+"/pp/"+b.id),h.find(".titleBox > a.comment > span").text(b.comments),h.find(".commentBox > .taskDescription").html(b.content);for(var o,p=b.comment_list,q=h.find(".actionBox > .commentList"),r=0;r<p.length;r++)o=e(p[r]),q.append(o);h.on("click",".star",function(a){a.preventDefault();var c=b.id,e=b.liked?"/api/tweet/"+c+"/unlike":"/api/tweet/"+c+"/like";return $.post(e,function(){b.liked=!b.liked,b.liked?b.likes+=1:b.likes-=1;var a=d(b);h.replaceWith(a),g=b}),!1}),h.on("click",".close",function(a){a.preventDefault();var c=confirm("确认删除该泡泡？");if(c){var d=b.id,e="/api/tweet/"+d;$.ajax({url:e,type:"DELETE",success:function(a){if(a.msg)for(var b in a.msg)alert(a.msg[b]);else h.remove()}})}return!1}),h.on("submit",".commentSubmit",function(a){a.preventDefault();var c=b.id,d=$(this).find("input"),f=$(this).find("button"),g="/api/tweet/"+c+"/comment";return $.post(g,{content:d.val()},function(a){if(a.msg)for(var b in a.msg)alert(a.msg[b]);if(a.data){a.data.owner={};var c=e(a.data);q.append(c)}d.removeAttr("disabled"),f.removeAttr("disabled")}),d.attr("disabled","disabled"),f.attr("disabled","disabled"),!1}),$("#accordion").after(h)}function e(a){var b='<li><div class="commenterImage"><a href="#"><img src="#" /></a></div><a class="commenterName" href="#"><span class="comment-meta"></span></a><div class="commentText"><p></p><span class="date sub-text"></span><a class="reply" href="#" class="comment-hash"> 回复 </a><a class="delete" href="#" class="comment-hash"> 删除 </a></div></li>',c=$(b),d=a.owner.name,e=a.owner.global_key;return c.find(".commenterImage > a").attr("href","/u/"+e),c.find(".commenterImage img").attr("src",a.owner.avatar),c.find("a.commenterName").attr("href","/u/"+e),c.find("a.commenterName > span").text(d),c.find(".commentText > p").html(a.content),c.find(".commentText > .date").text(new Date(a.created_at)),c.find(".commentText > a").attr("id",a.owner_id),c.on("click",".reply",function(a){a.preventDefault();
var b=c.parents(".commentList").next("form").find("input");if(""===b.val())b.val("@"+d);else{var e=b.val();b.val(e+", @"+d)}return!1}),c.on("click",".delete",function(b){b.preventDefault();var d=confirm("确认删除该评论？");if(d){var e=c.parents(".detailBox").attr("id"),f=a.id;path="/api/tweet/"+e+"/comment/"+f,$.ajax({url:path,type:"DELETE",success:function(a){if(a.msg)for(var b in a.msg)alert(a.msg[b]);else{for(var d=g.comment_list,e=d.length-1;e>=0;e--)d[e].id===f&&d.splice(e,1);c.remove()}}})}return!1}),c}function f(a){var b='<a class="pull-right" style="padding: 0 3px 0" href="#"><img src="#" height="15" width="15" /></a>',c=$(b);return c.attr("href","/u/"+a.global_key),c.find("img").attr("src",a.avatar),c}var g;return{template_url:"/views/pp_item.html",context:".container",before_enter:function(a){$("title").text(a+"的冒泡"),$("#page_name").text(a+"的冒泡"),$("#navigator").append('<li class="nav-divider"></li><li><a href="/pp/hot">热门</a></li>')},on_enter:function(c,d){a(c),b(c,d)},on_exit:function(){$("title").text(""),$("#page_name").text(""),$("#navigator > li").slice(-1).remove()}}}();!function(a,b,c,d){$(function(){var e=new Routy.Router(null,"a",".main","click longTap swipe");e.register("/projects",a),e.register("/u/:user/p/:project, /u/:user/p/:project/git, /u/:user/p/:project/code",b),e.register("/pp",c),e.register("/pp/:hot",c),e.register("/u/:user/pp/:pp",d)})}(PROJECT_ROUTE,PROJECT_ITEM_ROUTE,PP_ROUTE,PP_ITEM_ROUTE);